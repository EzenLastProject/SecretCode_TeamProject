<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"   lang="en" id="ht" >
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<link rel="stylesheet" th:href="@{/dist/css/theme.css}">
<link rel="stylesheet" th:href="@{/dist/css/myPage.css}">
<link rel="stylesheet" th:href="@{/dist/js/memberModify.js}">

<th:block th:replace="~{layout::setFragment(~{this::content})}">

  <th:block th:fragment="content" >

    <div class="myPagecontainer" id="top" style="text-align: center;">
      <div class="container-md" style="text-align: center;">
        <div class="myPageAllbox text-center">
          <span>My Page</span>
          <p></p>
          <div class="myName">

            <img th:src="@{/dist/image/myIcon11.png}" style="width:150px" height="150px">
            <th:block th:if="${#authorization.expression('isAuthenticated()')}">
              <h3 th:text="${#authorization.expression('hasRole(''ROLE_ADMIN'')') ? '관리자' : #authentication.name}"> </h3>
            </th:block>


          </div>
<!--          예약내역 확인  -->
          <div class="myReservBox">
            <div class="myReservTitle">
              <h3>나의 예약 현황</h3>
              <div class="myReserv">

                <table class="responsive-table board-table">
                  <thead>
                  <tr>
                    <th scope="col" >주문번호</th>
                    <th scope="col" >예약일</th>
                    <th scope="col" >예약시간</th>
                    <th scope="col" >테마</th>
                    <th scope="col" >예약자명</th>
                    <th scope="col">예약인원</th>
                    <th scope="col" >가격</th>
                    <th scope="col" >결제일</th>
                  </tr>
                  </thead>
                  <tbody>
                  <th:block th:each="myReservation : ${myreservaation}">
                    <tr>
                      <td th:text="${myReservation.merchantUid}"></td>
                      <td th:text="${myReservation.reservationDate}"></td>
                      <td th:text="${myReservation.reservationTime}"></td>
                      <td th:text="${myReservation.themeName}"></td>
                      <td th:text="${myReservation.name}"></td>
                      <td th:text="${myReservation.reservationPeople}"></td>
                      <td th:text="${myReservation.reservationPrice}"></td>
                      <td th:text="${myReservation.reservationPaydate}"></td>
                    </tr>
                  </th:block>
                  </tbody>
                </table>




              </div>
            </div>

          </div>
<!--          내가 쓴 qna -->
          <div class="myQNABox">
            <div class="myQNATitle">
              <h3>나의 Q & A</h3>
              <div class="myQNA">




                <table class="responsive-table board-table">
                  <thead>
                  <tr>
                    <th scope="col" >제목</th>
                    <th scope="col" >작성자</th>
                    <th scope="col" >내용</th>
                    <th scope="col" >작성일</th>
                    <th scope="col" >조회수</th>

                  </tr>
                  </thead>
                  <tbody>

                  <th:block th:each="myqna : ${myqna}">
                    <tr>
                      <td><a th:href="@{/qna/list}" th:text="${myqna.title}"></a></td>
<!--                      <td th:text="${myqna.title}"></td>-->
                      <td th:text="${myqna.writer}"></td>
                      <td th:text="${myqna.content}"></td>
                      <td th:text="${myqna.regDate}"></td>
                      <td th:text="${myqna.readCount}"></td>

                    </tr>
                  </th:block>
                  </tbody>

                </table>





              </div>
            </div>

          </div>
          <!--          내가 쓴 리뷰 -->
          <div class="myReviewBox">
            <div class="myReviewTitle">
              <h3>나의 리뷰</h3>
              <div class="myReview">


                <table class="responsive-table board-table">
                  <thead>
                  <tr>
                    <th scope="col" >제목</th>
                    <th scope="col" >작성자</th>
                    <th scope="col" >내용</th>
                    <th scope="col" >작성일</th>
                    <th scope="col" >테마</th>
                    <th scope="col" >조회수</th>

                  </tr>
                  </thead>
                  <tbody>

                  <th:block th:each="myreview : ${myreview}">
                    <tr>
                      <td><a th:href="@{/review/list}" th:text="${myreview.title}"></a></td>
<!--                      <td th:text="${myreview.title}"></td>-->
                      <td th:text="${myreview.writer}"></td>
                      <td th:text="${myreview.content}"></td>
                      <td th:text="${myreview.regDate}"></td>
                      <td th:text="${myreview.theme}"></td>
                      <td th:text="${myreview.readCount}"></td>

                    </tr>
                  </th:block>
                  </tbody>

                </table>








              </div>
            </div>

          </div>
<!--          회원정보 수정  -->
          <div class="myPageModify">
            <div class="modifyTitle">
              <h3>회원 정보 수정</h3>
              <div class="myModify">
                <form action="/member/modify" method="post" >
                  <div class="mb-3 container-sm">
                    <label for="email" class="form-label">이메일</label>
                    <input type="text" class="form-control"  id="email" placeholder="" name="email"   readonly="readonly" style="width: 50%; height : 40px; text-align: center; margin: 0 auto; display: block;">
                  </div>
                  <div class="mb-3 container-sm">
                    <label for="pwd" class="form-label">비밀번호</label>
                    <input type="password" class="form-control" id="pwd" placeholder="보안처리된 비밀번호"  name="pwd" style="width: 50%; height : 40px; text-align: center; margin: 0 auto; display: block;">
                  </div>
                  <div class="mb-3 container-sm">
                    <label for="nickName" class="form-label">닉네임</label>
                    <input type="text" class="form-control" id="nickName" placeholder="닉네임 입력..."  name="nickName" style="width: 50%; height : 40px; text-align: center; margin: 0 auto; display: block;">
                  </div>
                  <div class="mb-3 container-sm">
                    <label for="phone" class="form-label">휴대폰 번호</label>
                    <input type="text" class="form-control" id="phone" placeholder="" name="phone" maxlength="13" style="width: 50%; height : 40px; text-align: center; margin: 0 auto; display: block; margin-bottom:50px;" >
                  </div>
<!--                  <div class="mb-3 container-sm">-->
<!--                    <label for="lastLogin" class="form-label">마지막 접속일</label>-->
<!--                    <input type="text" class="form-control" id="lastLogin" placeholder="" name="lastLogin"  readonly="readonly" style="width: 50%; height : 40px; text-align: center; margin: 0 auto; display: block;">-->
<!--                  </div>-->


                  <button type="submit" class="btn btn-primary">수정</button>
                  <a href="/member/deleteMember"> <button type="button" class="btn btn-danger" onclick="removePopup()">회원탈퇴</button> </a>
                </form>
              </div>
            </div>
          </div>


        </div>
      </div>
    </div>

    <script>
    document.getElementById('phone').addEventListener('input', function (e) {
    var phone = e.target.value.replace(/[^0-9]/g, ''); // 숫자 이외의 문자 제거
    var len = phone.length;
    if (len < 4) {
    e.target.value = phone;
    } else if (len < 7) {
    e.target.value = phone.substring(0, 3) + '-' + phone.substring(3);
    } else if (len < 11) {
    e.target.value = phone.substring(0, 3) + '-' + phone.substring(3, 6) + '-' + phone.substring(6);
    } else {
    e.target.value = phone.substring(0, 3) + '-' + phone.substring(3, 7) + '-' + phone.substring(7, 11);
    }
    });
   </script>
  </th:block>

</th:block>
